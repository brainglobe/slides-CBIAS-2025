---
title: brainglobe-registration
subtitle: Registering 2D planes and 3D subvolumes to a 3D atlas
author: Igor Tatarnikov
date: 24 November 2025
format:
  revealjs:
    footer: "[brainglobe.info/slides-CBIAS-2025](https://brainglobe.info/slides-CBIAS-2025)"
---

## BrainGlobe Initiative {.smaller}

::: {.columns}
::: {.column width="55%"}
Established 2020 with three aims:

:::{.incremental}
1. Develop general-purpose tools to help others build interoperable software for computational neuroanatomy.
2. Develop specialist software for specific analysis and visualisation needs.
3. Reduce barriers of entry, and facilitate the building of an ecosystem of computational neuroanatomy tools.
:::

:::
::: {.column width="45%"}
![](img/tracing.png){.nostretch width="90%"}
:::
:::

## Understanding the brain

![](img/cajal_0_regions.jpg){.absolute .nostretch top="20%" left="5%" width="90%"}

::: {.fragment}
![](img/cajal_1_region.jpg){.absolute .nostretch top="20%" left="5%" width="90%"}
:::

::: {.fragment}
![](img/cajal_2_regions.jpg){.absolute .nostretch top="20%" left="5%" width="90%"}
:::

## Understanding the brain
![](img/1307_Brodmann_Areas.jpg){.absolute .nostretch left="5%" top="15%" width="90%"}

::: {style="background: #ffffff; width: 75%; height: 7%; margin: 0px; position: absolute; top: 90%; left: 12%"}
:::

## Brain atlases

::: {.fragment .absolute top="15%" left="0%" height="85%" width="50%" style="font-size: 0.7em; text-align: center;"}
![](img/allen_10um_annotations.png){.nostretch}
Annotation
:::

::: {.fragment .absolute top="15%" right="0%" width="50%" height="85%" style="font-size: 0.7em; text-align: center;"}
![](img/allen_10um_template.png){.nostretch}
Template
:::


## BrainGlobe atlases

### [brainglobe-atlasapi](https://github.com/brainglobe/brainglobe-atlasapi)

![](img/atlas.png){fig-align="center" .nostretch width="65%"}

![](img/noun-map-195855-EE9040.svg){.absolute .nostretch top="4%" width="10%" right="0%"}

::: footer
[Claudi, F. et al. (2020) “BrainGlobe Atlas API: a common interface for neuroanatomical atlases” JOSS, v5(54), 2668](https://doi.org/10.21105/joss.02668)
:::

## Whole-brain registration

### [`brainreg`](https://github.com/brainglobe/brainreg)

![](img/brainreg.png){.absolute .nostretch top="20%" width="90%" left="5%"}

![](img/noun-map-195855-EE9040.svg){.absolute .nostretch top="4%" width="10%" right="0%"}

::: {style="background: #ffffff; width: 15%; height: 65%; margin: 0px; position: absolute; top: 23%; right: 6%"}
:::

::: {.absolute top="32%" left="79%" style="font-size: 0.7em;"}
Allen Mouse<br/>
Brain Atlas
:::

::: {.absolute top="65%" left="79%" style="font-size: 0.7em;"}
Enhanced and<br/>
Unified Mouse<br/>
Brain Atlas
:::

::: footer
[Tyson, A. L. et al. (2022) “Accurate determination of marker location within whole-brain microscopy images” Sci Rep, 12, 867](https://doi.org/10.1038/s41598-021-04676-9)
:::


## 
![](img/example_slice_10um.png){.absolute .nostretch top="5%" left="0%" height="45%"}

::: {.fragment .fade-in}
![](img/atlas_slice_150_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_350_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_550_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_700_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_850_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_1050_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_1250_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_700_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/mi_original_space_aligned.png){.absolute .nostretch top="25%" right="0%" width="60%"}
:::

## 
![](img/pitched_slice_10um.png){.absolute .nostretch top="5%" left="0%" height="45%"}

::: {.fragment .fade-in}
![](img/atlas_slice_675_pitched_0_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_675_pitched_5_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_675_pitched_10_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_675_pitched_15_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_675_pitched_20_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment .fade-in}
![](img/atlas_slice_675_pitched_10_10um.png){.absolute .nostretch top="50%" left="0%" height="45%"}
:::

::: {.fragment}
![](img/mi_multi_angle.png){.absolute .nostretch top="24%" right="0%" width="60%"}
:::

::: {.fragment}
![](img/mi_multi_angle_heatmap.png){.absolute .nostretch top="25%" right="0%" width="60%"}
:::

::: {.fragment}
![](img/mi_multi_angle_heatmap_grid_4.png){.absolute .nostretch top="25%" right="0%" width="60%"}
:::

::: {.fragment}
![](img/mi_multi_angle_heatmap_grid_8.png){.absolute .nostretch top="25%" right="0%" width="60%"}
:::

::: {.fragment}
![](img/mi_multi_angle_heatmap_grid_16.png){.absolute .nostretch top="25%" right="0%" width="60%"}
:::

::: {.fragment}
![](img/mi_multi_angle_heatmap_grid_32.png){.absolute .nostretch top="25%" right="0%" width="60%"}
:::

::: {.fragment}
![](img/mi_multi_angle_heatmap_grid_64.png){.absolute .nostretch top="25%" right="0%" width="60%"}
:::

## Bayesian Optimisation

::: {.incremental}
1. Start by trying random parameters
2. Build a guess of the "match quality" landscape
3. Pick the next parameters to try based on this guess
4. Update the guess with the new result
5. Repeat steps 3-4
:::

##

![](img/bayesian_optimization.gif){.absolute .nostretch width="75%" top="10%" left="10%"}

::: {.fragment .fade-out style="background: #ffffffff; width: 100%; height: 41%; margin: 0px; position: absolute; top: 51%; right: 0%"}
:::

::: {.footer}
[https://bayesian-optimization.github.io/BayesianOptimization/master/index.html](https://bayesian-optimization.github.io/BayesianOptimization/master/index.html)
:::

## Bayesian Optimisation
![](img/num_iter_median_distance.png){.absolute .nostretch width="68%" top="22%" left="0%"}

::: {.fragment}
![](img/cbias_large_rep_comparison.png){.absolute .nostretch height="70%" top="25%" right="5%"}
:::

## [`brainglobe-registration`](https://github.com/brainglobe/brainglobe-registration)

![](img/brainglobe-registration-napari.png){.absolute .nostretch top="15%" left="10%" width="80%"}

## Acknowledgements
<br/>

Saarah Hussain<br/> Alessandro Felder<br/> Niko Sirmpilatze<br/> Adam Tyson

::: {.fragment}
![](img/swc.webp){.absolute height=120px top="55%" left="10%"}
![](img/GSoC-Vertical.png){.absolute height=350px top="31%" right="12%"} 
![](img/Chan_Zuckerberg_Initiative.png){.absolute height=112px top="79%" right="0%"}
![](img/funders.webp){.absolute width="78%" top="79%" left="0%"}
:::

## ![](img/BG_logo.png){height=70px style="margin-bottom: 0px; margin-top: 0px;"} [Contributors](https://brainglobe.info/people.html)
::: {.columns .gray_link_div style="font-size: 0.4em;"}
:::: {.column width="20%"}
[Christian Niedworok](https://github.com/cniedwor) <br/>
[Charly Rousseau](https://github.com/crousseau) <br/>
[Horst Obenhaus](https://github.com/horsto) <br/>
[Chryssanthi Tsitoura](https://github.com/chrytsi) <br/>
[Sepiedeh Keshavarzi](https://github.com/Sepidak) <br/>
[Mateo Vélez-Fort](https://github.com/velezmat) <br/>
[Stephen Lenzi](https://github.com/stephenlenzi) <br/>
[Rob Campbell](https://github.com/raacampbell) <br/>
[Alessandro Felder](https://github.com/alessandrofelder) <br/>
[Federico Claudi](https://github.com/FedeClaudi) <br/>
[Luigi Petrucco](https://github.com/vigji) <br/>
[Adam Tyson](https://github.com/adamltyson) <br/>
[Troy Margrie](https://github.com/troymargrie) <br/>
[Tiago Branco](https://github.com/ineuron) <br/>
[Ruben Portugues](https://github.com/portugueslab) <br/>
[Joe Ziminski](https://github.com/JoeZiminski) <br/>
[Sofia Miñano](https://github.com/sfmig) <br/>
[Niko Sirmpilatze](https://github.com/niksirbi) <br/>
[Nicholas Del Grosso](https://github.com/nickdelgrosso) <br/>
[Laura Porta](https://github.com/lauraporta) <br/>
[Lee Cossell](https://github.com/lcossell) <br/>
[Antonin Blot](https://github.com/ablot) <br/>
[David Pérez-Suárez](https://github.com/dpshelio) <br/>
[David Stansby](https://github.com/dstansby) <br/>
[Will Graham](https://github.com/willGraham01) <br/>
[Patrick Roddy](https://github.com/paddyroddy)
::::

:::: {.column width="20%"}
[Adrien Berchet](https://github.com/adrien-berchet) <br/>
[Mathieu Bourdenx](https://github.com/MathieuBo) <br/>
[bkntr](https://github.com/bkntr) <br/>
[NovaFae](https://github.com/novafae) <br/>
[David Young](https://github.com/yoda-vid) <br/>
[Sam Clothier](https://github.com/samclothier) <br/>
[Gubra-ApS](https://github.com/Gubra-ApS) <br/>
[Kailyn Fields](https://github.com/kailynkfields) <br/>
[ramroomh](https://github.com/ramroomh) <br/>
[Samuel Diebolt](https://github.com/sdiebolt) <br/>
[Chris Roat](https://github.com/chrisroat) <br/>
[Oren Amsalem](https://github.com/orena1) <br/>
[kclamar](https://github.com/kclamar) <br/>
[Draga Doncila Pop](https://github.com/DragaDoncila) <br/>
[juanma9613](https://github.com/juanma9613) <br/>
[Jules Scholler](https://github.com/JulesScholler) <br/>
[Iaroslavna Vasylieva](https://github.com/noisysky) <br/>
[Nicolas Peschke](https://github.com/npeschke) <br/>
[Justin Kiggins](https://github.com/neuromusic) <br/>
[Peter Sobolewski](https://github.com/psobolewskiPhD) <br/>
[Simão Bolota](https://github.com/SimaoBolota-MetaCell) <br/>
[chili-chiu](https://github.com/chili-chiu) <br/>
[jaimergp](https://github.com/jaimergp) <br/>
[Sebastian Lammers](https://github.com/seblammers) <br/>
[Matt Colligan](https://github.com/m-col) <br/>
[Paul Brodersen](https://github.com/paulbrodersen)
::::

:::: {.column width="20%"}
[Carter Peene](https://github.com/rcpeene) <br/>
[francesshei](https://github.com/francesshei) <br/>
[Sean Martin](https://github.com/seankmartin) <br/>
[Ben Dichter](https://github.com/bendichter) <br/>
[4iar](https://github.com/4iar) <br/>
[Marco Musy](https://github.com/marcomusy) <br/>
[Anna Medyukhina](https://github.com/amedyukhina) <br/>
[stegiopast](https://github.com/stegiopast) <br/>
[EmanPaoli](https://github.com/EmanPaoli) <br/>
[lidakanari](https://github.com/lidakanari) <br/>
[Alexis Arnaudon](https://github.com/arnaudon) <br/>
[Ziyang Liu](https://github.com/liu-ziyang) <br/>
[Philip Shamash](https://github.com/philshams) <br/>
[koushik-ms](https://github.com/koushik-ms) <br/>
[Harald Reingruber](https://github.com/haraldreingruber) <br/>
[Emily Jane Dennis](https://github.com/emilyjanedennis) <br/>
[Peak](https://github.com/pattarika) <br/>
[Maximilian Blacher](https://github.com/3ng7n33r) <br/>
[Hernando Martinez Vergara](https://github.com/HernandoMV) <br/>
[Estelle](https://github.com/enassar) <br/>
[nicole-vissers](https://github.com/nicole-vissers) <br/>
[GD](https://github.com/GDoumou) <br/>
[Michael Kunst](https://github.com/mkunst23) <br/>
[Estelle Nassar](https://github.com/estellenassar) <br/>
[Sara Mederos](https://github.com/SaraMederos) <br/>
[Igor Tatarnikov](https://github.com/IgorTatarnikov)
::::

:::: {.column width="20%"}
[Viktor Plattner](https://github.com/viktorpm) <br/>
[Carlo Castoldi](https://github.com/carlocastoldi) <br/>
[Jingjie Li](https://github.com/jingjie-li) <br/>
[Guillaume Le Goc](https://github.com/GuillaumeLeGoc) <br/>
[Harry Carey](https://github.com/PolarBean) <br/>
[Matt Einhorn](https://github.com/matham) <br/>
[Kimberly Meechan](https://github.com/K-Meech) <br/>
[Robert Kozol](https://github.com/Robkozol) <br/>
[Roberto](https://github.com/RobertoDF) <br/>
[Axel Bisi](https://github.com/abisi) <br/>
[Jung Woo Kim](https://github.com/kjungwoo5) <br/>
[Saima Abdus](https://github.com/saimaabdus19) <br/>
[Saarah Hussain](https://github.com/saarah815/) <br/>
[Sacha Hadaway-Andreae](https://github.com/sacha091) <br/>
[Presa](https://github.com/zenWai) <br/>
[Henry Crosswell](https://github.com/HenryCrosswell) <br/>
[Nischit Kumar](https://github.com/nischitkumar) <br/>
[Kirato Yoshihara](https://github.com/kira1228) <br/>
[Leonard Schwigon](https://orcid.org/0009-0004-1453-2638) <br/>
[Dinora Abdulazhanova](https://uol.de/ibu/neurosensorik/team/dinora-abdulazhanova) <br/>
[Katrin Haase](https://orcid.org/0000-0002-1365-2548) <br/>
[Dominik Heyers](https://orcid.org/0000-0002-2831-6985) <br/>
[Isabelle Museliak](https://orcid.org/0000-0001-7242-3123) <br/>
[Henrik Mouritsen](https://orcid.org/0000-0001-7082-4839) <br/>
[Simon Weiler](https://github.com/simonweiler) <br/>
[Stella Prins](https://github.com/stellaprins)
::::

:::: {.column width="20%"}
[Richard Dushime](https://github.com/richarddushime) <br/>
[Miguel Xochicale](https://github.com/mxochicale) <br/>
[M S P](https://github.com/msp99000) <br/>
[Abdul Samad](https://github.com/samadpls) <br/>
[Prisha Sharma](https://github.com/parharti) <br/>
[Farida Yusuf](https://github.com/frdysf) <br/>
[Anshu Saini](https://github.com/0Anshu1) <br/>
[Menna1812](https://github.com/Menna1812) <br/>
[ayush2281](https://github.com/ayush2281) <br/>
[BethCr](https://github.com/BethCr) <br/>
[Swapnaneel Patra](https://github.com/thisisrick25) <br/>
[Xiaoyu Deng](https://github.com/X-Deng) <br/>
[DwarvesEatRocks](https://github.com/DwarvesEatRocks) <br/>
[DPWebster](https://github.com/DPWebster) <br/>
[Conrad](https://github.com/conradRz) <br/>
[pranav33317](https://github.com/pranav33317) <br/>
[Biswanath Saha](https://github.com/Elsword016) <br/>
[Federico F.](https://github.com/Fede2717) <br/>
[Tim Monko](https://github.com/TimMonko) <br/>
[Kaixiang Shuai](https://github.com/Skxsmy) <br/>
[Giulia Paci](https://github.com/giuliapaci) <br/>
[Marco Dalla Vecchia](https://github.com/marcodallavecchia) <br/>
[Pavel Vychyk](https://github.com/p-vychik) <br/>
[Ishrat Zaman](https://github.com/ishratz25) <br/>
[Asma Bashir](https://github.com/DrABashir) <br/>
[Fatma S. Elsharkawy](https://github.com/FatmaElsharkawy)
::::
:::

::: {.footer}
[https://brainglobe.info/people.html](https://brainglobe.info/people.html)
:::

## Open Software Summer School 2026
::: {.absolute left="5%" top="22.5%" style="font-size: 0.5em;"}
For more information visit: [https://neuroinformatics.dev/open-software-summer-school/](https://neuroinformatics.dev/open-software-summer-school/)
:::

![](img/OSSS_2026_schedule.png){.absolute .nostretch top="40%" left="0%" width="100%" style="max-width: 100%;"}
![](img/OSSS_QR_code.png){.absolute .nostretch top="15%" right="5%" width="12%"}

::: {.footer}
[https://neuroinformatics.dev/open-software-summer-school/](https://neuroinformatics.dev/open-software-summer-school/)
:::
